# WMS拣选子系统
我们将WMS拆分为三部分，
1. 订单管理（销售订单），工单管理（入库单/盘点单等）
2. 库存和库位管理
3. 拣选，主要指对库存商品按照特定规则进行组合和移位，典型场景按订单出库，安排材料组织加工等
根据商品的属性（量大，重物），订单属性（一单多行，一单少行），需要选择不同的拣选方式以达到最有效率。拣选方式的实例有：
三个阶段有不同的策略控制，而这些控制逻辑，最终映射到几种拣选方式：
1. 素生鲜的边拣边拣边分：货位固定，由一台有固定分割（按门店分割/按订单分割）的移动容器，沿着货位将订单执行完毕
2. 素生鲜的总分总拣：货位固定，有分割的容器固定，先沿着货位，将容器要求的货收集完毕，然后到容器前，根据分割的要求，进行分拣
3. 鲜果的总分总拣（有大货）：货位固定，有分割的容器固定，先沿着货位，将容器要求的货收集完毕，然后到容器前，根据分割的要求，进行分拣。 
   这种方式，与素生鲜的总分总拣，没有区别，只是在订单单品数量和容器容量的关系上存在差别
4. 鲜果的摘果：一个容器（多个容器），一个订单，沿着固定货位，完成拣货
## 设计思想
拣选过程可以分成三个阶段
- 组波，即将进入的请求（订单）按照特定的规则，汇聚成一次作业批次，给到一个（组）作业人员执行
- 任务调度，将作业批次，分解成若干相关关联或者不关联的任务，并调度/分配给作业人员并行/串行执行
- 任务执行，跟踪和支持一个任务的执行，任务分配到具体个人，并引导其完成每一个步骤
### 组波逻辑
组波，是根据作业特性，将一组请求（订单）组成一个作业批次wave。在拣选方式的基础上，存在如下组波条件
1. 固定筛选条件，订单进入后，匹配条件组，将订单归到不同的批次
2. 波次饱满条件，出于效率考虑，只有一定的容量条件满足，才能出波次。当然也可以手工出波次
在上面的基础上，预留一个选项：支持拆单组波，即，将一个订单/请求，组到不同的波次，这个放在波次饱满条件上。波次饱满条件设上下限，超过上限需要，决定是否能拆单

基于这样的逻辑，实现上采用流水线方式，将订单按时间顺序通过组波逻中：
- 订单上预留波次号，同时承担记录本订单已经分配的状态
- 如果拆单，将拆单放在独立的队列中，不影响订单列表完整性。 在调用设计上考虑完整性
